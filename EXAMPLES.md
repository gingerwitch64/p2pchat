# Example Communications between Client and Server

## Registering a User

1. Client sends the following request to the server:

```
{
    "type": "REG" or "REGISTER",
    "username": "FooBar",
    "userid": a 32-character string generated by uuid.uuid4().hex
}
```

2. The server unpacks the request and checks if the `username` or `userid` is taken.
It then returns the following JSON:

```
{
    "type": "REG",
    "status": 0 or 1, depending on if the operation succeeded or failed (respectively)
}
```

3. If the returned status is not 0, the client can attempt to use another `username` (or `userid`, but based on the scope of the UUID's randomness, it's not likely to collide).

## Sending a Message

1. Client sends the following message request:

```
{
    "type": "MSG" or "MESSAGE",
    "userid": the 32-character string that the client registered with,
    "text": "An example message"
}
```

2. The server then matches the userid with a username from the database, generates a timestamp, and inserts the (Timestamp, UserName, Text) combo into the database.
While there is potential for failure, there shouldn't be anything that will cause the server to crash; thus, it will send back the following JSON:

```
{
    "type": "MSG",
    "status": 0
}
```

## Fetching Messages from the Server

1. The client will send the following message request, though only "since" or "last" has to be specified:

```
{
    "type": "GET" or "FETCH",
    "since": a Unix timestamp (float or int),
    "last": an integer indicating the (n) most recent messages
}
```

2. The server will interpret this as the following:

- If "since" is specified, the server will return all messages since the timestamp given;
- If "last" is specified, the server will return the last number of messages specified;
- If none are specified, the server will return the most recent message.

With a response such as this:

```
{
    "type": "GET",
    "messages": [
        (1727751800, "FooBar", "Hello world!"),
        (1727751880, "test123", "Testing testing"),
    ],
    "status": 0
}
```

If "status" is not 0, "messages" will be an empty list (the use case for this is, for example, if the client tries to request an absurd amount of messages).
The current plan is for messages to be delivered as tuples, as that's how they come out of the database by default.
